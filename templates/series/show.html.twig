{% extends 'base.html.twig' %}

{% block title %}Series
{% endblock %}
{% block main %}
	<div class="container white mt-5">
		{% include 'series/_serie_card.html.twig' %}
		<div class="row">
			<h2 class="liste-saisons-header border-bottom border-secondary mt-5 ms-2 pb-3 ps-0">Liste des saisons</h2>
			{% for season in series.seasons %}
				<div class="col-lg-2 col-md-4 col-sm-6 col-12 text-center mt-3 overflow-hidden">
					<div class="card-body overflow-hidden text-center p-0">
						<a href="{{ path('season_show', {'id': season.id}) }}">
							<img class="rounded poster" src="{{ path("series_poster", {"id": series.id}) }}" alt="Poster">
						</a>
					</div>
					<div class="card-footer border-0 bg-transparent text-center">
						<h5 class="card-text m-0">Saison
							{{ season.number }}
							{% if season in seasons_watched %}
								<i class="bi bi-patch-check-fill"></i>
							{% else %}
							<i class="bi bi-patch-check"></i>
							{% endif %}
						</h5>
						<h6>{{ season.episodes|length }}
							Ã©pisodes
						</h6>
					</div>
				</div>
			{% endfor %}
		</div>
		<div class="row">
			{% if app.user %}
				<h2 class="border-bottom border-secondary mt-5 ms-2 pb-3 ps-0">Laisser un commentaire</h2>
				{{ form_start(ratingForm,{
                'attr' : {'class': 'd-flex flex-wrap col-12 flex-column'}
            }) }}
				<div class="my-2">
					{{ form_label(ratingForm.comment, 'Commentaire',{
					'label_attr' : {'class': 'form-label'}
				}) }}
					{{ form_widget(ratingForm.comment,{
					'attr' : {'class': 'form-control'}
				}) }}

					<small>{{ form_help(ratingForm.comment) }}</small>

					<div class="form-error">
						{{ form_errors(ratingForm.comment) }}
					</div>
				</div>
				<div class="col-lg-1 col-2 my-2">
					Note :
					{{ form_widget(ratingForm.value,{
					'attr' : {'class': 'note border-0 border-bottom border-white p-0 d-inline white text-center', 'maxlength': '2'}
				}) }}/10

					<small>{{ form_help(ratingForm.value) }}</small>

					<div class="form-error">
						{{ form_errors(ratingForm.value) }}
					</div>

				</div>
				{{ form_end(ratingForm) }}
			{% endif %}
		</div>

		<div class="row">
			{% for rating in series.ratings %}
				<div class="d-flex flex-column col-lg-2 col-md-3 col-5 text-center commentaire rounded mx-3 my-3 px-0">
					<div class="pt-3 py-2 border-bottom pt-2">
						<p class="yellow m-0 fw-bold">{{ rating.user }}</p>
						<p class="red m-0 fw-bold">{{ rating.value }}/10</p>
					</div>
					<div class="py-2 mx-2">
						<p class="m-1">{{ rating.comment }}</p>
					</div>
					<div class="border-top pt-2 bg-dark py-2 mt-auto">
						<p class="m-0">
							{{ rating.date }}
							{% if is_granted('ROLE_ADMIN') %}
							<a href="{{ path('delete_rating', {'id': rating.id}) }}">
								<i class="bi bi-trash-fill"></i>
							</a>
							{% endif %}
						</p>
					</div>

				</div>
			{% endfor %}

		</div>
	</div>

	<a href="{{ path('series_index') }}">back to list</a>
	<a href="{{ path('series_edit', {'id': series.id}) }}">edit</a>
	{{ include('series/_delete_form.html.twig') }}
{% endblock %}
